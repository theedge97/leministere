	<!-- debut de head-->
    <%- include('head'); -%>
    <!--Fin de head -->
    <style>
      .error
    {
        color: red;
    }
    #erreurmotpasse, #erreurnumero
    {
        display: none;
    }
  
    </style> 
        <script src="/assets/semantic/assets/js/jquery.min.js"></script>
        <script src="/assets/semantic/assets/js/jquery.validate.js"></script>
      
        </head>
        <%- include('menue'); -%>
        
                    <main class="col-md-9  ms-sm-auto col-lg-10 px-md-4">
                        <div class="row">

                            <div class="d-block d-sm-flex flex-nowrap align-items-center">
                                <div class="page-title text-primary mb-2 mb-sm-0">
                                    <h1>liste des   Comptes </h1>
                                </div>
                               
                            </div>
                            <div class="d-block d-lg-flex flex-nowrap align-items-center">
                              <div class="page-title text-primary mb-2 mb-sm-0">
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal" class="mb-5 offset-lg-0 offset-xs-5 btn btn-primary">Ajoutez un Compte</button>  </div>
                              <!--Ajout modale-->
                              
  <!-- Modal Ajout article-->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-primary">
          <h5 class="modal-title " id="exampleModalLabel">Ajout d'un Compte</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
           <form method="post" action="/Superadmin/Compteajout"   id="ajout"> 
                                       
        <div class="mb-3"> 
        <input type="number" class="form-control p-3" id="numcpte" name="numcpte" placeholder="Entrez le numéro de compte " required> 
        </div>   
        <div class="mb-3"> 
          <input type="text" class="form-control p-3" id="decrit" name="decrit" placeholder="Description de Compte" required> 
          </div>
          <div class="mb-3 text-dark"> 
            <legend>Veuillez selectionner le type de compte </legend>
            <% if(typeof type !== "undefined"){ %>
              <% for(var i= 0 ; i < type.length; i++)  {%> 
            
            <label for="gender_male<%= type[i].idtypcpte %>">
              <input type="radio" id="gender_male<%= type[i].idtypcpte %>" value="<%= type[i].idtypcpte %>" class="mt-3 mb-2 m-2" name="type" required><%= type[i].libcpte %>
            </label>
            <% } %>
                                                <% } %>

        </div> 

                                                                              
                                      <div class="text-end">
  
          <button type="button" class="btn btn-secondary " data-bs-dismiss="modal">Fermer</button>
                                          <button type="submit" class="btn btn-primary pe-4 ps-4 rounded-pill">
                                              <span>Enregistrer</span>
                                          </button>
                                      </div>                                     
                                  </form>
        </div>
      </div>
    </div>
  </div>
                            <!--Fin -->
                             
                          </div>
                           
                          
                        </div>
                        <hr class="text-primary">
                        <div class="row">
                          <div class="col-12  col-lg-12">
                            <div class="card card-statistics">
                                <div class="card-header">
                                    <div class="card-heading">
                                        <h4 class="card-title text-primary">Liste des  compte </h4>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table mb-0">
                                            <caption>Liste des  comptes</caption>
                                            <thead>
                                            
                                                <tr>
                                                    <th scope="col">#</th>
                                                    <th scope="col">Numero de  compte</th>
                                                    <th scope="col">Intitilé de   compte</th>
                                                    <th scope="col">Type  de  compte</th>
                                                    <th scope="col">Modifier  compte</th>
                                                    <th scope="col">Suppression de compte</th>
                                                </tr>
                                               
                                            </thead>
                                            <tbody>
                                              <% if(typeof compte !== "undefined"){ %>
                                                <% for(var i= 0 ; i < compte.length; i++)  {%> 
                                                <tr>
                                                    <th scope="row"><%= i+1 %></th>
                                                    <td><%= compte[i].numcpte %></td>
                                                    <td><%= compte[i].intcompte %></td>
                                                    <td><%= compte[i].libcpte %></td>
                                                    <td> <button data-bs-toggle="modal" data-bs-target="#modifi<%= compte[i].idcompte %>"  class="btn btn-info btn-xs"><svg  enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#0B2D3F"><g><rect fill="none" height="24" width="24"/></g><g><g><g><polygon points="3,17.25 3,21 6.75,21 17.81,9.94 14.06,6.19"/></g><g><path d="M20.71,5.63l-2.34-2.34c-0.39-0.39-1.02-0.39-1.41,0l-1.83,1.83l3.75,3.75l1.83-1.83C21.1,6.65,21.1,6.02,20.71,5.63z"/></g></g></g></svg></button></td>
                                                    <td><button data-bs-toggle="modal" data-bs-target="#supprime<%= compte[i].idcompte %>"  class="btn btn-info btn-xs"><svg  height="24px" viewBox="0 0 24 24" width="24px" fill="#0B2D3F"><path d="M0 0h24v24H0z" fill="none"/><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg></button></td>
                                        
                                                </tr>
                 <!--Boite suppression-->
         <div class="modal fade" id="supprime<%= compte[i].idcompte %>" tabindex="-1" role="dialog" aria-labelledby="defaultModal" aria-hidden="true">
          <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header bg-primary">
                  <h5 class="modal-title " id="exampleModalLabel">Suppression d'un compte</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                  <div class="modal-body text-dark">
                      Voulez-vous supprimer  le numero de compte  <%= compte[i].numcpte %> (<%= compte[i].intcompte %>)
                  </div>
                  <div class="modal-footer">
                      <button type="button" class="btn btn-secondary " data-bs-dismiss="modal">Non</button>
                      <a href="/Superadmin/CompteSupprimer/<%= compte[i].idcompte %>"><button type="button" class="btn btn-danger">Oui</button></a>
                  </div>
              </div>
          </div>
      </div>
      <!--Boite suppression fin-->

      
<!-- Modifier  nom du pays-->
<div class="modal fade" id="modifi<%= compte[i].idcompte %>" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-primary">
        <h5 class="modal-title" id="exampleModalLabel">Modification des informations du numéros de  compte <%= compte[i].numcpte %> (<%= compte[i].intcompte %>) </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form action="/Superadmin/Modifiernumecpte" accept="" id="numcptemodifier<%= compte[i].idcompte %>" method="post" >
          <div class="form-group">
              <input type="number" id="modifienumcpte" name="modifienumcpte" placeholder="Entrez le Numero de compte" class="form-control modifienumcpte p-3" required>
              <input type="hidden" value="<%= compte[i].idcompte %>"  name="idcptes"  class="col col-md-5 form-control">
              <button type="submit"  class="btn btn-secondary  pe-4 ps-4 rounded-pill col-md-9 mb-3 mt-2">Modifier le Numéro de compte</button>
          </div>
      </form>
       <form action="/Superadmin/Modifierintitulecpte" id="intitulecpte<%= compte[i].idcompte %>" method="post" class="titreformation">
          <div class="form-group">
              <input type="text" name="modifierintitule" id="modifierintitule" placeholder="Entrez l'Intitulé de compte" class="form-control modifierintitule p-3"  >
              <input type="hidden" value="<%= compte[i].idcompte %>"  name="idcptes"  class="col col-md-5 form-control">
              <button type="submit" class="btn btn-secondary   pe-4 ps-4 rounded-pill mb-3 mt-2">Modifier 	Intitilé de compte</button>
          </div>
      </form>
      <form action="/Superadmin/Modifiertypecompte" id="typecpte<%= compte[i].idcompte %>" method="post" class="detailsformation">
          <div class="form-group">
            
          <div class="mb-3 text-dark"> 
            <legend>Veuillez selectionner le type de compte </legend>
            <% if(typeof type !== "undefined"){ %>
              <% for(var j= 0 ; j < type.length; j++)  {%> 
            
            <label for="male<%= compte[i].idcompte %><%= type[j].idtypcpte %>">
              <input type="radio" id="male<%= compte[i].idcompte %><%= type[j].idtypcpte %>" value="<%= type[j].idtypcpte %>" class="mt-3 mb-2 m-2" name="typecompte" required><%= type[j].libcpte %>
            </label>
            
            <% } %>
                                                <% } %>
                                                <input type="hidden" value="<%= compte[i].idcompte %>"  name="idcptes"  class="col col-md-5 form-control">
             
          </div>
              <button type="submit" class="btn btn-secondary  pe-4 ps-4 rounded-pill mb-3 mt-2 ">Modifier le type de compte</button>
          </div>
      </form>
      
      </div>
    </div>
  </div>
</div>
                          <!--Fin -->
                          <script>
    
                            $().ready(function() {
                                // validate the comment form when it is submitted
                                jQuery.validator.addMethod("phoneGuinee", function (phone_number, element) {
                                phone_number = phone_number.replace(/\s+/g, "");
                                return this.optional(element) || phone_number.length >= 9 && phone_number.match(/^6[1,2,5,6]{1}[0-9]{7}$/);
                            }, "Veuillez Entrez le bon format de Numero");
                         // add the rule here
                         jQuery.validator.addMethod(
                                  "notEqualTo",
                                  function(elementValue,element,param) {
                                    return elementValue != param;
                                  },
                                  "Veuillez Selectionnez un element"
                                );
                        //Modifier le nom de l'article 
                                $("#numcptemodifier<%= compte[i].idcompte %>").validate({
                        rules: {
                                     
                          modifienumcpte: {
                                            required: true,
                                            minlength: 3
                                        }
                                    },
                           messages: {
                            modifienumcpte: {
                                            required: "Veuillez inserer  le nom de l'article",
                                            minlength: "Vous devez avoir un Nom d'article supperieur 2 caractere"
                                        }
                                    },
                        
                        submitHandler: function(form){
                        $("#lespiner").css({ 
                                              display: 'block'
                                            });
                            var formData = new FormData(form);
                        $.ajax({
                            url: form.action,
                            type: form.method,
                            data:  $(form).serialize(),
                            success: function(response) {
                             if (response.sucess) {
                                           
                                        setTimeout(function () {     
                                          window.location.href ='/Superadmin/LesCompte'
                                  }, 1500);
                                         } 
                                         if (response.erreurnumcpte) {
                                       
                                         //si le compte n'est pas engistrer
                                  $(".modifienumcpte").css({ 
                                             border: "1px solid red"
                                            });
                                        
                                         } 
                                    
                                
                                           }            
                              });       
                        }
                        });

                        //Modifier l intituler de compte 
                        $("#intitulecpte<%= compte[i].idcompte %>").validate({
                        rules: {
                                     
                          modifierintitule: {
                                            required: true,
                                            minlength: 3
                                        }
                                    },
                           messages: {
                            modifierintitule: {
                                            required: "Veuillez inserer  l'intituler  de compte",
                                            minlength: "Vous devez avoir un intituler de compte "
                                        }
                                    },
                        
                        submitHandler: function(form){
                        $("#lespiner").css({ 
                                              display: 'block'
                                            });
                            var formData = new FormData(form);
                        $.ajax({
                            url: form.action,
                            type: form.method,
                            data:  $(form).serialize(),
                            success: function(response) {
                             if (response.sucess) {
                                           
                                        setTimeout(function () {     
                                          window.location.href ='/Superadmin/LesCompte'
                                  }, 1500);
                                         } 
                                         if (response.erreurintuler) {
                                       
                                         //si le compte n'est pas engistrer
                                  $(".modifierintitule").css({ 
                                             border: "1px solid red"
                                            });
                                        
                                         } 
                                    
                                
                                           }            
                              });       
                        }
                        });
                        //Modification du type de compte 
                        $("#typecpte<%= compte[i].idcompte %>").validate({
                        rules: {
                                     
                          typecompte: {
                                            required: true,
                                            
                                        }
                                    },
                           messages: {
                            typecompte: {
                                            required: "Veuillez inserer  l'intituler  de compte",
                                        }
                                    },
                        
                        submitHandler: function(form){
                        $("#lespiner").css({ 
                                              display: 'block'
                                            });
                            var formData = new FormData(form);
                        $.ajax({
                            url: form.action,
                            type: form.method,
                            data:  $(form).serialize(),
                            success: function(response) {
                             if (response.sucess) {
                                           
                                        setTimeout(function () {     
                                          window.location.href ='/Superadmin/LesCompte'
                                  }, 1500);
                                         } 
                                         if (response.erreurtype) {
                                       
                                         //si le compte n'est pas engistrer
                                  $(".typecompte").css({ 
                                             border: "1px solid red"
                                            });
                                        
                                         } 
                                    
                                
                                           }            
                              });       
                        }
                        });
                                // propose username by combining first- and lastname
                                $("#username").focus(function() {
                                    var firstname = $("#firstname").val();
                                    var lastname = $("#lastname").val();
                                    if (firstname && lastname && !this.value) {
                                        this.value = firstname + "." + lastname;
                                    }
                                });
                                
                                //code to hide topic selection, disable for demo
                                var newsletter = $("#newsletter");
                                // newsletter topics are optional, hide at first
                                var inital = newsletter.is(":checked");
                                var topics = $("#newsletter_topics")[inital ? "removeClass" : "addClass"]("gray");
                                var topicInputs = topics.find("input").attr("disabled", !inital);
                                // show when newsletter is checked
                                newsletter.click(function() {
                                    topics[this.checked ? "removeClass" : "addClass"]("gray");
                                    topicInputs.attr("disabled", !this.checked);
                                });
                            });
                            </script>
                    <!--Fin de Modifier-->
  
                           
                                                <% } %>
                                                <% } %>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                          
                        </div>
                        
                    </main>
                </div>
            </div>
            <script src="/assets/semantic/assets/js/popper.min.js"></script>
            <script src="/assets/semantic/bootstrap/js/bootstrap.min.js"></script>
         <script>
           
           $().ready(function() {
              // validate the comment form when it is submitted
              jQuery.validator.addMethod("phoneGuinee", function (phone_number, element) {
                phone_number = phone_number.replace(/\s+/g, "");
                return this.optional(element) || phone_number.length >= 9 && phone_number.match(/^6[1,2,5,6]{1}[0-9]{7}$/);
            }, "Veuillez Entrez le bon format de Numero");
              // validate signup form on keyup and submit
              $("#ajout").validate({
                rules: {
              
                  decrit: {
                    required: true
                  },
                  numcpte: {
                    required: true
                  },
                  type: {
                    required: true
                  }
                  
                },
                messages: {
                 
                  decrit: {
                    required: "Veuillez fournir une description de compte"
                   },
                   numcpte: {
                     required: "Veuillez fournir un numero de compte"
                   },
                   type: {
                     required: "Veuillez selectionner un type de compte"
                   }
                },
                
          submitHandler: function(form){
       
       $.ajax({
           url: form.action,
           type: form.method,
           data: $(form).serialize(),
           success: function(response) {
            
      
                      if (response.success) { 
                        window.location.href = "/Superadmin/LesCompte";
                     
                      } 
                      if (response.erreurmotpasse) {
  
                          $("#erreurnumero").css({ 
                        display: 'block'
                      });
                     
                  } 
                      if (response.erreurnumero) {
  
                          $("#erreurmotpasse").css({ 
                        display: 'block'
                      });
                    
                  } 
                         
               
               
                          }            
             });       
       }
       
              });
          
              //code to hide topic selection, disable for demo
              var newsletter = $("#newsletter");
              // newsletteGHr topics are optional, hide at first
              var inital = newsletter.is(":checked");
              var topics = $("#newsletter_topics")[inital ? "removeClass" : "addClass"]("gray");
              var topicInputs = topics.find("input").attr("disabled", !inital);
              // show when newsletter is checked
              newsletter.click(function() {
                topics[this.checked ? "removeClass" : "addClass"]("gray");
                topicInputs.attr("disabled", !this.checked);
              });
            });
            </script>
        
        </body>
    </html>
    
	<!-- debut de head-->
    <%- include('head'); -%>
    <!--Fin de head -->
    <style>
      .error
    {
        color: red;
    }
    #erreurmotpasse, #erreurnumero
    {
        display: none;
    }
    .dot {
     background-color: #198754;
     border-radius: 10px; 
   margin-right: 6px; 
     width: 10px; 
     height: 10px; 
     display: inline-block; 
}
.dotplus {
     background-color: #dc3545;
     border-radius: 10px; 
   margin-right: 6px; 
     width: 10px; 
     height: 10px; 
     display: inline-block; 
}
    </style> 
        <script src="/assets/semantic/assets/js/jquery.min.js"></script>
        <script src="/assets/semantic/assets/js/jquery.validate.js"></script>
        <script src="/assets/semantic/assets/js/moment.min.js"></script>
        </head>
        <%- include('menue'); -%>
        
                    <main class="col-md-9  ms-sm-auto col-lg-10 px-md-4">
                        <div class="row">
                            <div class="d-block d-sm-flex flex-nowrap align-items-center">
                                <div class="page-title text-primary mb-2 mb-sm-0">
                                    <h1>liste des Agents  </h1>
                                </div>
                               
                            </div>
                            <div class="d-block d-lg-flex flex-nowrap align-items-center">
                              <div class="page-title text-primary mb-2 mb-sm-0">
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal" class="mb-5 offset-lg-0 offset-xs-5 btn btn-primary">Ajoutez un Agents</button>  </div>
                              <!--Ajout modale-->
                              
  <!-- Modal Ajout article-->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-primary">
          <h5 class="modal-title " id="exampleModalLabel">Ajout d'un Agent</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
           <form method="post" action="/Superadmin/Ajoutagent"   id="ajout"> 
            <div class="mb-3"> 
              <select name="ambassadeid" id="ambassadeid" class="form-control p-3">
              
                <option>Veuillez selectionner l'Ambassade </option>
                <% for(var e= 0 ; e < lesamba.length; e++)  {%> 
                  <option  value="<%= lesamba[e].idamb %>">Ambassade de <%= lesamba[e].pays %></option>
                    <% } %>
  
              </select >
              </div>                
        <div class="mb-3"> 
        <input type="text" class="form-control p-3" id="nom" name="nom" placeholder="Entrez le nom " required> 
        </div>   
        <div class="mb-3"> 
          <input type="text" class="form-control p-3" id="prenom" name="prenom" placeholder="Entrez le prenom" required> 
        </div> 
        <div class="mb-3"> 
          <input type="date" class="form-control p-3" id="ladate" name="ladate"  required> 
        </div> 
        <div class="mb-3"> 
          <input type="text" class="form-control p-3" id="matricule" name="matricule" placeholder="Entrez le matricule" required> 
        </div> 
        <div class="mb-3 text-dark"> 
          <legend>Selectionner le sex </legend>
          <label for="gender_male">
            <input type="radio" id="gender_male" value="m" name="genre" required>Maxculin
          </label>
          <label for="gender_female">
            <input type="radio" class="text-primary" id="gender_female" value="f" name="genre">Feminin
          </label>
      </div> 
        <div class="mb-3"> 
          <input type="tel" class="form-control p-3" id="telephone" name="telephone" placeholder="Entrez le Numero de telephone" required> 
        </div> 
        <div class="mb-3"> 
          <input type="text" class="form-control p-3" id="email" name="email" placeholder="Entrez votre email" required> 
        </div> 
        <div class="mb-3"> 
          <input type="file" class="form-control p-3" id="photo" name="photo" placeholder="Entrez le prenom" required> 
        </div> 
        <div class="mb-3"> 
          <input type="password" class="form-control p-3" id="motdepasse" name="motdepasse" placeholder="Entrez le mot de passe" required> 
        </div> 
        <div class="mb-3"> 
          <input type="password" class="form-control p-3" id="motdepasse1" name="motdepasse1" placeholder="Confirmer  le mot de passe" required> 
        </div> 
                                                                              
                                      <div class="text-end">
  
          <button type="button" class="btn btn-secondary " data-bs-dismiss="modal">Fermer</button>
                                          <button type="submit" class="btn btn-primary pe-4 ps-4 rounded-pill">
                                              <span>Enregistrer</span>
                                          </button>
                                      </div>                                     
                                  </form>
        </div>
      </div>
    </div>
  </div>
                            <!--Fin -->
                             
                          </div>
                          
                        </div>
                        <hr class="text-primary">
                        <div class="row">
                          <div class="col-12  col-lg-12">
                            <div class="card card-statistics">
                                <div class="card-header">
                                    <div class="card-heading">
                                        <h4 class="card-title text-primary">Liste des Agents </h4>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table mb-0">
                                            <caption>Liste des Agents </caption>
                                            <thead>
                                            
                                                <tr>
                                                    <th scope="col">#</th>
                                                    <th scope="col">Matricule</th>
                                                    <th scope="col">Nom</th>
                                                    <th scope="col">Prenom </th>
                                                    
                                                    <th scope="col">Téléphone</th>
                                                    <th scope="col">Sex</th>
                                                    <th scope="col">Date de Naissance</th>
                                                    <th scope="col">Ambassade</th>
                                                    <th scope="col">Statue</th>
                                                    <th scope="col">Voir</th>
                                                    <th scope="col">Supprimer</th>
                                                    
                                                </tr>
                                               
                                            </thead>
                                            <tbody>
                                              <% if(typeof agent !== "undefined"){ %>
                                                <% for(var i= 0 ; i < agent.length; i++)  {%> 
                                                <tr>
                                                    <th scope="row"><%= i+1 %></th>
                                                    <td><%= agent[i].matricule %></td>
                                                    <td><%= agent[i].nom %></td>
                                                    <td><%= agent[i].prenom %></td>
                                                    
                                                    <td><%= agent[i].telephone %></td>
                                                    <td><%= agent[i].sex %></td>
                                                    <td><em id="unedate<%= i+1 %>">

                                                    </em>
                                                    <script>
                                                      var date = "<%= agent[i].datenaissance %>";
                                                      var ladate =  moment(date).format('DD / MM / YYYY ');
                                                      $("#unedate<%= i+1 %>").html(ladate);
                                                      </script></td>
                                                    <td><%= agent[i].pays %></td>
                                                    <td> <% if(agent[i].statue == 0){ %><span  class=" text-primary dotplus"  ></span>Desactiver<% } %> <% if(agent[i].statue == 1){ %><span  class="dot text-primary "  ></span>Activer<% } %> </td>
                                                    <td> <button data-bs-toggle="modal" data-bs-target="#modifierpays"  class="btn btn-info btn-xs"><a href="/Superadmin/Voiragent/<%= agent[i].idagentamba %>"><svg xmlns="http://www.w3.org/2000/svg" width="24px" fill="#0B2D3F" class="ionicon" viewBox="0 0 512 512"><title>Voir</title><path d="M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 00-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 000-17.47C428.89 172.28 347.8 112 255.66 112z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/><circle cx="256" cy="256" r="80" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/></svg></a></button></td>
                                                    <td><button data-bs-toggle="modal" data-bs-target="#supprimer<%= agent[i].idagentamba %>"  class="btn btn-info btn-xs"><svg  height="24px" viewBox="0 0 24 24" width="24px" fill="#0B2D3F"><path d="M0 0h24v24H0z" fill="none"/><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg></button></td>
                                                </tr>
                                                 <!--Boite  suppression-->
           <div class="modal fade" id="supprimer<%= agent[i].idagentamba %>" tabindex="-1" role="dialog" aria-labelledby="defaultModal" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header bg-primary">
                    <h5 class="modal-title " id="exampleModalLabel">Suppression d'un Agent</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                    <div class="modal-body text-dark">
                        Voulez-vous supprimer  l'Agent <%= agent[i].nom %> ...?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary " data-bs-dismiss="modal">Non</button>
                        <a href="/Superadmin/AgentSupprimer/<%= agent[i].idagentamba %>"><button type="button" class="btn btn-danger">Oui</button></a>
                    </div>
                </div>
            </div>
        </div>
        <!--Boite suppression fin-->                          
           
                                                <% } %>
                                                <% } %>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                          
                        </div>
                        
                    </main>
                </div>
            </div>
            <script src="/assets/semantic/assets/js/popper.min.js"></script>
            <script src="/assets/semantic/bootstrap/js/bootstrap.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js" integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE" crossorigin="anonymous"></script>
         <script>
           
           $().ready(function() {
              // validate the comment form when it is submitted
              jQuery.validator.addMethod("phoneGuinee", function (phone_number, element) {
                phone_number = phone_number.replace(/\s+/g, "");
                return this.optional(element) || phone_number.length >= 9 && phone_number.match(/^6[1,2,5,6]{1}[0-9]{7}$/);
            }, "Veuillez Entrez le bon format de Numero");
              // validate signup form on keyup and submit
              $("#ajout").validate({
                rules: {
              
                  nom: {
                    required: true,
                    minlength: 3
                  },
                  prenom: {
                    required: true,
                    minlength: 3
                  },
                  ladate :{
                    required: true
                  },
                  matricule: {
                    required: true,
                    minlength: 5
                  },
                  genre:{
                    required: true
                  },
                  telephone:{
                    required: true
                  },
                  email: {
                    required: true,
                    email: true
                  },
                  photo:{
                    required: true
                  },
                  motdepasse: {
                    required: true,
                    minlength: 5
                },
                motdepasse1: {
                    required: true,
                    minlength: 5,
                    equalTo: "#motdepasse"
                },
                },
                messages: {
                 
                  nom: {
                    required: "Veuillez fournir un nom",
                    minlength: "Veuillez inserer un nom superieur a trois caractere"
                   },
                   prenom: {
                    required: "Veuillez fournir un prenom",
                    minlength: "Veuillez inserer un nom superieur a trois caractere"
                   },
                   ladate: {
                     required: "Veuillez fournir une date"
                   },
                   matricule: {
                    required: "Veuillez fournir un matricule",
                    minlength: "Veuillez inserer un matricule de  5 caractere"
                   },
                   telephone:{
                     required: "Veuillez entrez le numero téléphone"
                   },
                   genre:{
                     required: "Veuillez selectionner le genre"
                   },
                   email: {
                     required: "Veuillez entez votre email",
                     email: "Veuillez entrez un email valide "
                   },
                   photo: {
                     required: "Veuillez selectionner une photo"
                   },
                motdepasse: {
                    required: "Veuillez inserer un mot de passe",
                    minlength: "Vous devez avoir un mot de passe supperieur a 5 caractere"
                },
                motdepasse1: {
                    required: "Veuillez inserer un mot de passe",
                    minlength: "Vous devez avoir un mot de passe supperieur a 5 caractere",
                    equalTo: "Veuillez inserer le meme mot de passe"
                }
                },
                
          submitHandler: function(form){
       
       $.ajax({
           url: form.action,
           type: form.method,
           data: $(form).serialize(),
           success: function(response) {
            
      
                      if (response.success) { 
                        window.location.href = "/Superadmin/LesAngentAmbassade";
                     
                      } 
                      if (response.erreurmotpasse) {
  
                          $("#erreurnumero").css({ 
                        display: 'block'
                      });
                     
                  } 
                      if (response.erreurnumero) {
  
                          $("#erreurmotpasse").css({ 
                        display: 'block'
                      });
                    
                  } 
                         
               
               
                          }            
             });       
       }
       
              });
          
              //code to hide topic selection, disable for demo
              var newsletter = $("#newsletter");
              // newsletteGHr topics are optional, hide at first
              var inital = newsletter.is(":checked");
              var topics = $("#newsletter_topics")[inital ? "removeClass" : "addClass"]("gray");
              var topicInputs = topics.find("input").attr("disabled", !inital);
              // show when newsletter is checked
              newsletter.click(function() {
                topics[this.checked ? "removeClass" : "addClass"]("gray");
                topicInputs.attr("disabled", !this.checked);
              });
            });
            </script>
        
        </body>
    </html>
    